{"version":3,"file":"BoxDetail-CHloerNV.js","sources":["../../src/utils/randomizer.ts","../../src/components/boxOpening/BoxDetail.tsx"],"sourcesContent":["import { boxesData } from '../data/boxesData';\n\nexport interface BoxReward {\n  code: string;\n  amount: number;\n}\n\nexport const generateReward = (boxId: string): BoxReward => {\n  const box = boxesData[boxId];\n  if (!box) throw new Error('Box not found');\n\n  // Mystery Gift Box için özel kontrol\n  if (boxId === 'mystery-gift') {\n    // Sadece 1key ve 5key kodlu ödülleri filtrele\n    const allowedDrops = box.drops.filter(drop => drop.code && (drop.code === '1key' || drop.code === '5key'));\n    \n    if (allowedDrops.length === 0) {\n      throw new Error('No valid drops found for mystery gift box');\n    }\n\n    // Toplam olasılık hesapla (sadece izin verilen ödüller için)\n    const totalProbability = allowedDrops.reduce((sum, drop) => sum + drop.rarity, 0);\n    \n    // Rastgele sayı üret\n    let random = Math.random() * totalProbability;\n    \n    // Ödülü seç\n    for (const drop of allowedDrops) {\n      random -= drop.rarity;\n      if (random <= 0 && drop.code) {\n        return {\n          code: drop.code,\n          amount: 1\n        };\n      }\n    }\n    \n    // Eğer bir şekilde seçim yapılamazsa varsayılan olarak 1key ver\n    return {\n      code: '1key',\n      amount: 1\n    };\n  }\n\n  // Diğer kutular için normal mantık\n  const validDrops = box.drops.filter(drop => drop.code);\n  if (validDrops.length === 0) {\n    throw new Error('No valid drops found for box');\n  }\n\n  const totalProbability = validDrops.reduce((sum, drop) => sum + drop.rarity, 0);\n  let random = Math.random() * totalProbability;\n\n  for (const drop of validDrops) {\n    random -= drop.rarity;\n    if (random <= 0 && drop.code) {\n      return {\n        code: drop.code,\n        amount: 1\n      };\n    }\n  }\n\n  // Varsayılan dönüş - ilk geçerli ödülü kullan\n  const firstValidDrop = validDrops[0];\n  if (!firstValidDrop || !firstValidDrop.code) {\n    throw new Error('No valid drops found');\n  }\n\n  return {\n    code: firstValidDrop.code,\n    amount: 1\n  };\n}; ","import React, { useState, useEffect } from 'react';\nimport { Box, Typography, Button, Container, Grid, IconButton, CircularProgress, Drawer, Snackbar, Alert  } from '@mui/material';\nimport { motion } from 'framer-motion';\nimport ArrowBackIcon from '@mui/icons-material/ArrowBack';\nimport { useNavigate, useParams } from 'react-router-dom';\nimport { doc, updateDoc, increment, onSnapshot, getDoc } from 'firebase/firestore';\nimport { db } from '../../pages/firebase';\nimport { generateReward, BoxReward } from '../../utils/randomizer';\nimport BoxOpenAnimation from './BoxOpenAnimation';\nimport RewardDisplay from './RewardDisplay';\nimport KeyIcon from '@mui/icons-material/Key';\nimport { boxesData } from '../../data/boxesData';\nimport CloseIcon from '@mui/icons-material/Close';\nimport RemoveIcon from '@mui/icons-material/Remove';\nimport AddIcon from '@mui/icons-material/Add';\nimport axios from 'axios';\nimport DepositDrawer from '../WalletDrawers/DepositDrawer';\nimport SwapDrawer from '../WalletDrawers/SwapDrawer';\nimport tonLogo from '../../assets/kucukTON.png';\nimport { PackageOpenIcon } from 'lucide-react';\nconst usdtLogo = 'https://cryptologos.cc/logos/tether-usdt-logo.png';\n\n// Import all box images\n\n\n\n\n\ninterface UserStats {\n  usdt: number;\n  total: number;\n  keys: number;\n  keyParts: number;\n  totalBoxes: number;\n  distributedBoxes: number;\n  giftBox: number;\n  boxes: Record<string, number>;\n  drops: Record<string, { code: string; amount: number; }[]>;\n}\n\ninterface DisplayReward {\n  code: string;\n  name: string;\n  image: string;\n  price: string;\n  rarity: number;\n  amount: number;\n}\n\n// Renk değişiklikleri için stil güncellemeleri\nconst commonStyles = {\n  primaryColor: '#6ed3ff',\n  primaryGradient: 'linear-gradient(90deg, #6ed3ff, #8ee9ff)',\n  bgGradient: 'linear-gradient(135deg, rgba(110, 211, 255, 0.3) 0%, rgba(110, 211, 255, 0.1) 100%)',\n  borderColor: 'rgba(110, 211, 255, 0.2)',\n  hoverBorderColor: 'rgba(110, 211, 255, 0.4)',\n  buttonShadow: '0 4px 12px rgba(110, 211, 255, 0.3)',\n  buttonHoverShadow: '0 6px 16px rgba(110, 211, 255, 0.4)',\n};\n\nconst BoxDetail: React.FC = () => {\n  const navigate = useNavigate();\n  const { boxId } = useParams<{ boxId: string }>();\n  const boxData = boxId ? boxesData[boxId] : null;\n  const [userStats, setUserStats] = useState<UserStats | null>(null);\n  const [isOpening, setIsOpening] = useState(false);\n  const [currentReward, setCurrentReward] = useState<DisplayReward | null>(null);\n  const [showReward, setShowReward] = useState(false);\n  const [error, setError] = useState<string | null>(null);\n  const [loading, setLoading] = useState(true);\n  const [showPurchaseModal, setShowPurchaseModal] = useState(false);\n  const [quantity, setQuantity] = useState(1);\n  const [tonPrice, setTonPrice] = useState<number | null>(null);\n  const [selectedPayment, setSelectedPayment] = useState<'TON' | 'USDT'>('TON');\n  const [showDepositDrawer, setShowDepositDrawer] = useState(false);\n  const [showSwapDrawer, setShowSwapDrawer] = useState(false);\n  const [neededAmount, setNeededAmount] = useState<number>(0);\n  const [showSuccessSnackbar, setShowSuccessSnackbar] = useState(false);\n  const [successMessage, setSuccessMessage] = useState('');\n\n  useEffect(() => {\n    const telegramUserId = localStorage.getItem(\"telegramUserId\");\n    if (!telegramUserId) {\n      navigate('/spin');\n      return;\n    }\n\n    const unsubscribe = onSnapshot(\n      doc(db, 'users', telegramUserId),\n      (doc) => {\n        if (doc.exists()) {\n          const data = doc.data();\n          // Initialize usdt with 0 if it doesn't exist\n          setUserStats({\n            ...data,\n            usdt: data.usdt ?? 0,\n          } as UserStats);\n        } else {\n          setError('Kullanıcı verisi bulunamadı');\n        }\n        setLoading(false);\n      },\n      (error) => {\n        console.error('Error fetching user stats:', error);\n        setError('Veriler yüklenirken hata oluştu');\n        setLoading(false);\n      }\n    );\n\n    return () => unsubscribe();\n  }, [navigate]);\n\n  useEffect(() => {\n    const fetchTonPrice = async () => {\n      try {\n        const response = await axios.get(`https://api.binance.com/api/v3/ticker/price`, {\n          params: { symbol: 'TONUSDT' },\n        });\n        const newTonPrice = parseFloat(response.data.price);\n        setTonPrice(newTonPrice);\n      } catch (error) {\n        console.error('Error fetching TON price:', error);\n      }\n    };\n\n    fetchTonPrice();\n    const interval = setInterval(fetchTonPrice, 30000); // Update every 30 seconds\n\n    return () => clearInterval(interval);\n  }, []);\n\n  useEffect(() => {\n    if (canPurchase()) {\n      setError(null);\n      setNeededAmount(0);\n    }\n  }, [userStats, quantity, selectedPayment]);\n\n  const updateUserStats = async (userId: string, reward: BoxReward) => {\n    const userRef = doc(db, 'users', userId);\n    \n    const updates: any = {\n      keys: increment(-1)\n    };\n\n    // Mystery Gift Box için özel güncelleme\n    if (boxId === 'mystery-gift') {\n      updates.giftBox = increment(-1);\n      \n      // Key parts için özel artış\n      if (reward.code === '1key') {\n        updates.keyParts = increment(1);\n      } else if (reward.code === '5key') {\n        updates.keyParts = increment(5);\n      }\n    } else {\n      // Normal kutular için standart işlem\n      updates[`boxes.${boxData?.title}`] = increment(-1);\n      \n      // Kullanıcının drops listesini güncelle\n      const userDoc = await getDoc(doc(db, 'users', userId));\n      const userData = userDoc.data() as UserStats;\n      const existingDrops = userData.drops || {};\n      const userDrops = existingDrops[boxData?.title || ''] || [];\n      \n      // Aynı koda sahip drop var mı kontrol et\n      const existingDropIndex = userDrops.findIndex(drop => drop.code === reward.code);\n      \n      if (existingDropIndex !== -1) {\n        // Varsa miktarını artır\n        userDrops[existingDropIndex].amount += 1;\n      } else {\n        // Yoksa yeni ekle\n        userDrops.push(reward);\n      }\n      \n      updates[`drops.${boxData?.title}`] = userDrops;\n    }\n    \n    await updateDoc(userRef, updates);\n  };\n\n  const getBoxOpeningStatus = (stats: UserStats | null) => {\n    if (!stats) return { canOpen: false, message: 'Veriler yükleniyor...' };\n    \n    // Mystery Gift Box için özel kontrol\n    if (boxId === 'mystery-gift') {\n      const hasGiftBox = stats.giftBox > 0;\n      const hasKeys = stats.keys > 0;\n\n      if (!hasGiftBox && !hasKeys) {\n        return { \n          canOpen: false, \n          message: 'Kutu açmak için Gift Box ve anahtarınız olması gerekiyor' \n        };\n      }\n      \n      if (!hasGiftBox) {\n        return { \n          canOpen: false, \n          message: `${stats.keys} anahtarınız var fakat Gift Box'ınız yok` \n        };\n      }\n      \n      if (!hasKeys) {\n        return { \n          canOpen: false, \n          message: `${stats.giftBox} Gift Box'ınız var fakat anahtarınız yok` \n        };\n      }\n      \n      return { \n        canOpen: true, \n        message: `${stats.giftBox} Gift Box ve ${stats.keys} anahtarınız var` \n      };\n    }\n\n    // Diğer kutular için normal kontrol\n    const boxCount = stats.boxes?.[boxData?.title || ''] || 0;\n    const hasKeys = stats.keys > 0;\n\n    if (boxCount === 0 && !hasKeys) {\n      return { \n        canOpen: false, \n        message: 'Kutu açmak için kutunuz ve anahtarınız olması gerekiyor' \n      };\n    }\n    \n    if (boxCount === 0) {\n      return { \n        canOpen: false, \n        message: `${stats.keys} anahtarınız var fakat ${boxData?.title} kutunuz yok` \n      };\n    }\n    \n    if (!hasKeys) {\n      return { \n        canOpen: false, \n        message: `${boxCount} ${boxData?.title} kutunuz var fakat anahtarınız yok` \n      };\n    }\n    \n    return { \n      canOpen: true, \n      message: `${boxCount} ${boxData?.title} kutu ve ${stats.keys} anahtarınız var` \n    };\n  };\n\n  const handleOpenBox = async () => {\n    const telegramUserId = localStorage.getItem(\"telegramUserId\");\n    const status = getBoxOpeningStatus(userStats);\n    \n    if (!status.canOpen) {\n      setError(status.message);\n      return;\n    }\n\n    setError(null);\n    setIsOpening(true);\n    setShowReward(false);\n\n    try {\n      const reward = generateReward(boxId!);\n      await updateUserStats(telegramUserId!, reward);\n      \n      // Ödül bilgilerini bul\n      const drop = boxData?.drops.find(d => d.code === reward.code);\n      if (!drop) throw new Error('Drop not found');\n      \n      setCurrentReward({\n        code: reward.code,\n        name: drop.name,\n        image: drop.image,\n        price: drop.price,\n        rarity: drop.rarity,\n        amount: reward.amount\n      });\n    } catch (error) {\n      console.error('Error opening box:', error);\n      setError('Kutu açılırken bir hata oluştu');\n      setIsOpening(false);\n    }\n  };\n\n  const handleBuyBox = () => {\n    setShowPurchaseModal(true);\n  };\n\n  const handleQuantityChange = (change: number) => {\n    const newQuantity = quantity + change;\n    if (newQuantity >= 1) {\n      setQuantity(newQuantity);\n    }\n  };\n\n  const handleConfirmPurchase = async () => {\n    const telegramUserId = localStorage.getItem(\"telegramUserId\");\n    if (!telegramUserId || !userStats) {\n      setError('User not found');\n      return;\n    }\n\n    const totalPrice = parseFloat(calculateTotal());\n    const userBalance = selectedPayment === 'TON' ? \n      (typeof userStats.total === 'number' ? userStats.total / 1000 : 0) : \n      (typeof userStats.usdt === 'number' ? userStats.usdt : 0);\n    const needed = totalPrice - userBalance;\n\n    if (userBalance < totalPrice) {\n      setNeededAmount(selectedPayment === 'USDT' ? needed : needed * (tonPrice || 0));\n      setError(`You need ${needed.toFixed(2)} more ${selectedPayment} (≈ $${\n        selectedPayment === 'TON' ? \n        (needed * (tonPrice || 0)).toFixed(2) : \n        needed.toFixed(2)\n      })`);\n      return;\n    }\n\n    try {\n      setError(null);\n      const userRef = doc(db, 'users', telegramUserId);\n      const updates: any = {};\n\n      if (selectedPayment === 'TON') {\n        updates.total = increment(-(totalPrice * 1000));\n      } else {\n        updates.usdt = increment(-totalPrice);\n      }\n\n      updates[`boxes.${boxData?.title}`] = increment(quantity);\n\n      await updateDoc(userRef, updates);\n\n      setSuccessMessage(`Successfully purchased ${boxData?.title}!`);\n      setShowSuccessSnackbar(true);\n      \n      setTimeout(() => {\n        setShowPurchaseModal(false);\n        setQuantity(1);\n      }, 1000);\n\n    } catch (error) {\n      console.error('Error purchasing box:', error);\n      setError('Error occurred while purchasing box. Please try again.');\n    }\n  };\n\n  const calculateTotal = () => {\n    const usdPrice = parseFloat(boxData?.salePrice || '0') * quantity;\n    if (selectedPayment === 'TON' && tonPrice) {\n      return (usdPrice / tonPrice).toFixed(2);\n    }\n    return usdPrice.toFixed(2);\n  };\n\n  const formatBalance = (value: number | undefined | null, paymentType: 'TON' | 'USDT'): string => {\n    if (typeof value !== 'number') return '0.00';\n    if (paymentType === 'TON') {\n      return (value / 1000).toFixed(2);\n    }\n    return value.toFixed(2);\n  };\n\n  const getUserBalance = (stats: UserStats | null, paymentType: 'TON' | 'USDT'): number => {\n    if (!stats) return 0;\n    if (paymentType === 'TON') {\n      return (stats.total || 0) / 1000;\n    }\n    return (stats.usdt || 0);\n  };\n\n  const canPurchase = () => {\n    if (!userStats) return false;\n    const totalPrice = parseFloat(calculateTotal());\n    const userBalance = getUserBalance(userStats, selectedPayment);\n    return userBalance >= totalPrice;\n  };\n\n  if (!boxData) {\n    return (\n      <Container maxWidth=\"lg\">\n        <Box //@ts-ignore\n         sx={{ py: 4, textAlign: 'center' }}>\n          <Typography variant=\"h4\" sx={{ color: 'white' }}>\n            Box not found\n          </Typography>\n          <Button\n            onClick={() => navigate('/mystery-box')}\n            sx={{ mt: 2, color: 'white' }}\n          >\n            Go Back\n          </Button>\n        </Box>\n      </Container>\n    );\n  }\n\n  if (loading) {\n    return (\n      <Container maxWidth=\"lg\">\n        <Box sx={{ display: 'flex', justifyContent: 'center', alignItems: 'center', minHeight: '60vh' }}>\n          <CircularProgress />\n        </Box>\n      </Container>\n    );\n  }\n\n  const {\n    title,\n    image,\n    description,\n    normalPrice,\n    salePrice,\n    drops\n  } = boxData;\n\n  const status = getBoxOpeningStatus(userStats);\n\n  return (\n    <Container  maxWidth=\"lg\">\n      {/* Return Button */}\n      <Box sx={{ py: 2 }}>\n        <IconButton \n          onClick={() => navigate('/mystery-box')}\n          sx={{ color: 'white' }}\n        >\n          <ArrowBackIcon /> \n          <Typography sx={{ ml: 1, color: 'white' }}>\n            Return to Boxes\n          </Typography>\n        </IconButton>\n      </Box>\n\n      {/* Main Content */}\n    \n        {/* Box Info Section */}\n        <Box sx={{ \n          background: commonStyles.bgGradient,\n          borderRadius: '15px',\n          p: 3,\n      \n          border: `1px solid ${commonStyles.borderColor}`,\n          '&:hover': {\n            border: `1px solid ${commonStyles.hoverBorderColor}`,\n            boxShadow: commonStyles.buttonHoverShadow\n          }\n        }}>\n          <Grid container spacing={4}>\n            {/* Left Side - Image */}\n            <Grid item xs={12} sx={{ textAlign: 'center' }}>\n              <motion.div\n                initial={{ opacity: 0, y: 20 }}\n                animate={{ opacity: 1, y: 0 }}\n                transition={{ duration: 0.5 }}\n              >\n                <Box\n                  component=\"img\"\n                  src={image}\n                  alt={title}\n                  sx={{\n              \n                    width: '50%',\n                    height: 'auto',\n                    margin: '0 auto',\n                    display: 'block'\n                  }}\n                />\n              </motion.div>\n            </Grid>\n\n            {/* Right Side - Info */}\n            <Grid mt={-3} item xs={12}>\n                <Typography variant=\"h4\" sx={{ color: 'white', fontWeight: 'bold', textAlign: 'center' }}>\n                  {title} \n                </Typography>\n\n                <Typography sx={{ \n                  color: 'rgba(255,255,255,0.7)', \n                  textAlign: 'center', \n                  maxWidth: '800px', \n                  margin: '0 auto', \n                  px: 2,\n                  fontSize: boxId === 'mystery-gift' ? '0.8rem' : '1rem',\n                  lineHeight: boxId === 'mystery-gift' ? '1.6' : '1.5'\n                }}>\n                  {boxId === 'mystery-gift' \n                    ? \"Deposit TON and collect FREE Mystery Box. Start collecting now and join thousands of winners.\" \n                    : description\n                  }\n                </Typography>\n\n                <Box sx={{ \n                  display: 'flex', \n                  alignItems: 'center', \n                  justifyContent: 'center', \n                  gap: 2,\n                  height: '60px',\n                  position: 'relative',\n                  mt: 2\n                }}>\n                  <Typography\n                    sx={{\n                      color: 'rgba(255,255,255,0.5)',\n                      textDecoration: 'line-through',\n                      fontSize: '1.2rem',\n                      position: 'relative',\n                      zIndex: 1,\n                      display: 'block'\n                    }}\n                  >\n                    ${normalPrice}  \n                  </Typography>\n                  <Typography\n                    sx={{\n                      color: '#89d9ff',\n                      fontWeight: 'bold',\n                      fontSize: '2.5rem',\n                      position: 'relative',\n                    }}\n                  >\n                    ${salePrice}\n                  </Typography>\n                </Box>\n\n                <Box sx={{ px:2 }}>\n                  {error && (\n                    <Typography sx={{ color: '#ff4444', mb: 2, textAlign: 'center' }}>\n                      {error}\n                    </Typography>\n                  )}\n                  <Button\n                    variant=\"contained\"\n                    fullWidth\n                    onClick={handleOpenBox}\n                    disabled={!status.canOpen || isOpening}\n                    sx={{\n                      textTransform: 'none',\n                      background: commonStyles.primaryGradient,\n                      color: 'black',\n                     \n                      '&.Mui-disabled': {\n                        background: 'rgba(110, 211, 255, 0.1)',\n                        color: 'rgba(255, 255, 255, 0.4)'\n                      }\n                    }}\n                  >\n                    {isOpening ? (\n                      <CircularProgress size={24} color=\"inherit\" />\n                    ) : (\n                      <>\n                        {!status.canOpen ? 'Open Box' : 'Open Box'}\n                      </>\n                    )}\n                  </Button>\n\n                  {!status.canOpen && (\n                    <>\n                      {boxId === 'mystery-gift' ? \n                        (userStats?.giftBox && userStats.giftBox > 0 && !userStats?.keys) ? (\n                          <Button\n                            variant=\"contained\"\n                            fullWidth\n                            onClick={() => navigate('/mystery-box', { state: { defaultTab: 'craft' } })}\n                            sx={{\n                              mt: 1,\n                              background: 'linear-gradient(90deg, #6C7BDC, #6C7BDC80)',\n                              color: 'white',\n                              textTransform: 'none',\n                            }}\n                          >\n                            Craft Key\n                          </Button>\n                        ) : (\n                          <Button\n                            variant=\"contained\"\n                            fullWidth\n                            onClick={() => setShowDepositDrawer(true)}\n                            sx={{\n                              mt: 1,\n                              background: 'linear-gradient(90deg, #0088CC, #00A3FF)',\n                              color: 'white',\n                              textTransform: 'none',\n                            }}\n                          >\n                            Collect Free Box\n                          </Button>\n                        )\n                      : // Normal kutular için\n                        ((userStats?.boxes?.[boxData?.title] || 0) > 0 && !userStats?.keys) ? (\n                          <Button\n                            variant=\"contained\"\n                            fullWidth\n                            onClick={() => navigate('/mystery-box', { state: { defaultTab: 'craft' } })}\n                            sx={{\n                              mt: 1,\n                              background: 'linear-gradient(90deg, #6C7BDC, #6C7BDC80)',\n                              color: 'white',\n                              textTransform: 'none',\n                            }}\n                          >\n                            Craft Key\n                          </Button>\n                        ) : (\n                          <Button\n                            variant=\"contained\"\n                            fullWidth\n                            onClick={handleBuyBox}\n                            sx={{\n                              mt: 1,\n                              background: 'linear-gradient(90deg, #4CAF50, #45a049)',\n                              color: 'white',\n                              textTransform: 'none',\n                            }}\n                          >\n                            Buy Box\n                          </Button>\n                        )\n                      }\n                    </>\n                  )}\n\n                   <Typography sx={{ color: 'rgba(255,255,255,0.7)', mt: 1, textAlign: 'center' }}>\n                    {status.message}\n                  </Typography>\n                  <Box //@ts-ignore\n                    sx={{ \n                    display: 'flex', \n                    justifyContent: 'center', \n                    gap: 2, \n                    mt: 1, mb:1\n                  }}>\n                    <Box sx={{ \n                      display: 'flex', \n                      alignItems: 'center', \n                      gap: 0.5,\n                      background: 'rgba(255,255,255,0.1)',\n                      borderRadius: '8px',\n                      px: 2,\n                    }}>\n                      <PackageOpenIcon />\n                      <Typography color=\"white\" fontSize=\"0.9rem\">\n                        {boxId === 'mystery-gift' ? userStats?.giftBox || 0 : userStats?.boxes?.[boxData?.title] || 0}\n                      </Typography>\n                    </Box>\n                    <Box sx={{ \n                      display: 'flex', \n                      alignItems: 'center', \n                      gap: 0.5,\n                      background: 'rgba(255,255,255,0.1)',\n                      borderRadius: '8px',\n                      px: 2,\n                      py: 1\n                    }}>\n                      <KeyIcon sx={{ color: 'white', fontSize: '1.2rem' }} />\n                      <Typography color=\"white\" fontSize=\"0.9rem\">\n                        {userStats?.keys || 0}\n                      </Typography>\n                    </Box>\n                  </Box>\n                 \n                </Box>\n\n                {/* Box Opening Animation Modal */}\n                <BoxOpenAnimation \n                  isOpening={isOpening} \n                  onAnimationComplete={() => {\n                    setIsOpening(false);\n                    setShowReward(true);\n                  }}\n                  onClose={() => setIsOpening(false)}\n                />\n\n                {/* Reward Display Modal */}\n                {currentReward && (\n                  <RewardDisplay \n                    reward={currentReward} \n                    isVisible={showReward}\n                    onClose={() => {\n                      setShowReward(false);\n                      setCurrentReward(null);\n                    }}\n                  />\n                )}\n             \n            </Grid>\n          </Grid>\n        </Box>\n\n        {/* Drops Section */}\n        <Box sx={{ mt: 4, mb:14, borderRadius: '20px' }}>\n          <Typography variant=\"h5\" sx={{ color: '#6C7BDC',  fontWeight: 'bold' }}>\n            Drops in {title} ({drops.length})\n          </Typography>\n          <Typography variant=\"subtitle1\" sx={{ color: 'white', mb: 1 }}>\n            Unbox to collect one of products below:\n          </Typography>\n           \n          <Grid container spacing={1}>\n            {drops.sort((a, b) => a.rarity - b.rarity).map((item, index) => (\n              <Grid item xs={6} key={index}>\n                <Box\n                  sx={{\n                    position: 'relative',\n                    bgcolor: '#1a1b23',\n                    borderRadius: '12px',\n                    overflow: 'hidden',\n                    transition: 'transform 0.2s',\n                    borderTop: '2px solid',\nborderBottom:'2px solid',                    borderColor: () => {\n                      const rarity = item.rarity;\n                      if (rarity < 0.001) return '#e4c03d'; // Ultra Rare - Gold\n                      if (rarity < 0.01) return '#ff4d4d'; // Very Rare - Red\n                      if (rarity < 0.05) return '#9147ff'; // Rare - Purple\n                      if (rarity < 0.1) return '#4287f5'; // Uncommon - Blue\n                      return '#808080'; // Common - Gray\n                    },\n                  }}\n                >\n                  <Typography\n                    variant=\"h6\"\n                    sx={{\n                      color: 'white',\n                      fontWeight: 'bold',\n                      p: 2,\n                      pb: 0,\n                      fontSize: {xs: '0.9rem', sm: '1.2rem'},\n                    }}\n                  >\n                    {item.name}\n                  </Typography>\n           \n                  <Box\n                    component=\"img\"\n                    src={item.image}\n                    alt={item.name}\n                    sx={{\n                      width: '100%',\n                      height: {xs: '100px'},\n                      objectFit: 'contain',\n                      p: 1,\n                      mb:2,\n                  \n                    }}\n                  />\n                  <Box sx={{  }}>\n                    <Box\n                      sx={{\n                        position: 'absolute',\n                        bottom: '30px',\n                        left: '50%',\n                        transform: 'translateX(-50%)',\n                        bgcolor: '#6C7BDC',\n                        borderRadius: '8px',\n                        px: {xs: 2, sm: 4},\n                        py: {xs: 1, sm: 1.5},\n                        minWidth: {xs: '120px', sm: '200px'},\n                        textAlign: 'center',\n                        boxShadow: '0 4px 8px rgba(0,0,0,0.2)',\n                      }}\n                    >\n                      <Typography\n                        variant=\"h6\"\n                        sx={{\n                          color: 'white',\n                          fontWeight: 'bold',\n                          fontSize: {xs: '0.9rem', sm: '1.25rem'},\n                        }}\n                      >\n                        ${item.price}\n                      </Typography>\n                    </Box>\n                    <Box\n                      sx={{\n                        position: 'absolute',\n                        bottom: '5px',\n                        right: '10px',\n                        color: 'rgba(255,255,255,0.6)',\n                        fontSize: {xs: '0.8rem', sm: '1rem'},\n                      }}\n                    >\n                      {(item.rarity * 100).toFixed(4)}%\n                    </Box>\n                  </Box>\n                  <Box sx={{ height: {xs: '60px', sm: '70px'} }} />\n                </Box>\n              </Grid>\n            ))}\n          </Grid>\n      \n      </Box>\n\n      {/* Purchase Drawer */}\n      <Drawer\n        anchor=\"bottom\"\n        open={showPurchaseModal}\n        onClose={() => {\n          setShowPurchaseModal(false);\n          setQuantity(1);\n          setError(null);\n        }}\n        sx={{\n          '& .MuiDrawer-paper': {\n            background: 'linear-gradient(145deg, rgba(26,27,35,0.95) 0%, rgba(26,27,35,0.98) 100%)',\n            borderLeft: `1px solid ${commonStyles.borderColor}`,\n            maxHeight: '80vh'\n          }\n        }}\n      >\n        <Box sx={{\n          bgcolor: '#1a1b23',\n          p: { xs: 2, sm: 4 },\n          borderTop: '1px solid rgba(255,255,255,0.1)',\n          borderTopLeftRadius: '20px',\n          borderTopRightRadius: '20px',\n          position: 'relative',\n          height: '80vh',\n          overflowY: 'auto'\n        }}>\n          <IconButton\n            onClick={() => {\n              setShowPurchaseModal(false);\n              setQuantity(1);\n            }}\n            sx={{\n              position: 'absolute',\n              right: { xs: 8, sm: 16 },\n              top: { xs: 8, sm: 16 },\n              color: 'white',\n            }}\n          >\n            <CloseIcon />\n          </IconButton>\n\n          <Typography variant=\"h4\" sx={{ \n            color: 'white', \n            textAlign: 'center', \n            mb: { xs: 2, sm: 4 },\n            fontSize: { xs: '1.5rem', sm: '2rem' },\n            fontWeight: 'bold'\n          }}>\n            Buy {title}\n          </Typography>\n\n          <Box\n            component=\"img\"\n            src={image}\n            alt={title}\n            sx={{\n              width: { xs: '150px', sm: '200px' },\n              height: 'auto',\n              display: 'block',\n              margin: '0 auto',\n              mb: { xs: 2, sm: 4 },\n            }}\n          />\n\n          <Typography variant=\"h6\" sx={{ \n            color: 'white', \n            textAlign: 'center', \n            mb: 2,\n            fontSize: { xs: '1rem', sm: '1.25rem' },\n            opacity: 0.9\n          }}>\n            Number of boxes to purchase\n          </Typography>\n\n          {/* Quantity Selection Buttons */}\n          <Box sx={{ \n            display: 'flex', \n            alignItems: 'center', \n            justifyContent: 'center',\n            gap: { xs: 1, sm: 2 },\n            mb: { xs: 3, sm: 4 },\n          }}>\n            <IconButton \n              onClick={() => handleQuantityChange(-1)}\n              sx={{ \n                color: 'white',\n                background: 'rgba(110, 211, 255, 0.05)',\n                border: '1px solid rgba(110, 211, 255, 0.1)',\n                borderRadius: '12px',\n                width: { xs: 40, sm: 48 },\n                height: { xs: 40, sm: 48 },\n                transition: 'all 0.3s ease',\n                '&:hover': {\n                  background: 'rgba(110, 211, 255, 0.15)',\n                  border: '1px solid rgba(110, 211, 255, 0.3)',\n                  transform: 'scale(1.05)',\n                  boxShadow: '0 8px 32px rgba(110, 211, 255, 0.15)'\n                },\n                '&:active': {\n                  transform: 'scale(0.95)'\n                }\n              }}\n            >\n              <RemoveIcon sx={{ \n                fontSize: { xs: '1.2rem', sm: '1.5rem' },\n                color: '#6ed3ff'\n              }} />\n            </IconButton>\n            <Typography \n              sx={{ \n                color: '#6ed3ff',\n                fontSize: { xs: '1.5rem', sm: '2rem' },\n                minWidth: { xs: '120px', sm: '150px' },\n                textAlign: 'center',\n                background: 'rgba(110, 211, 255, 0.05)',\n                borderRadius: '12px',\n                py: { xs: 0.8, sm: 1 },\n                border: '1px solid rgba(110, 211, 255, 0.1)',\n                boxShadow: 'inset 0 2px 4px rgba(0,0,0,0.1)',\n                transition: 'all 0.3s ease',\n                '&:hover': {\n                  background: 'rgba(110, 211, 255, 0.08)',\n                  border: '1px solid rgba(110, 211, 255, 0.2)',\n                }\n              }}\n            >\n              {quantity}\n            </Typography>\n            <IconButton \n              onClick={() => handleQuantityChange(1)}\n              sx={{ \n                color: 'white',\n                background: 'rgba(110, 211, 255, 0.05)',\n                border: '1px solid rgba(110, 211, 255, 0.1)',\n                borderRadius: '12px',\n                width: { xs: 40, sm: 48 },\n                height: { xs: 40, sm: 48 },\n                transition: 'all 0.3s ease',\n                '&:hover': {\n                  background: 'rgba(110, 211, 255, 0.15)',\n                  border: '1px solid rgba(110, 211, 255, 0.3)',\n                  transform: 'scale(1.05)',\n                  boxShadow: '0 8px 32px rgba(110, 211, 255, 0.15)'\n                },\n                '&:active': {\n                  transform: 'scale(0.95)'\n                }\n              }}\n            >\n              <AddIcon sx={{ \n                fontSize: { xs: '1.2rem', sm: '1.5rem' },\n                color: '#6ed3ff'\n              }} />\n            </IconButton>\n          </Box>\n\n          {/* Payment Method Selection */}\n          <Box sx={{ \n            display: 'flex',\n            gap: 2,\n            mb: 2\n          }}>\n            <Button\n              onClick={() => setSelectedPayment('TON')}\n              sx={{\n                flex: 1,\n                height: '64px',\n                background: selectedPayment === 'TON' \n                  ? 'rgba(110, 211, 255, 0.15)'\n                  : 'rgba(110, 211, 255, 0.05)',\n                border: `1px solid ${selectedPayment === 'TON' ? 'rgba(110, 211, 255, 0.3)' : 'rgba(110, 211, 255, 0.1)'}`,\n                borderRadius: '12px',\n                transition: 'all 0.3s ease',\n                transform: selectedPayment === 'TON' ? 'scale(1.02)' : 'scale(1)',\n                boxShadow: selectedPayment === 'TON' ? '0 8px 32px rgba(110, 211, 255, 0.15)' : 'none',\n              \n              }}\n            >\n              <Box sx={{ textAlign: 'center' }}>\n                <Typography sx={{ \n                  color: selectedPayment === 'TON' ? '#6ed3ff' : 'rgba(255,255,255,0.6)',\n                  fontSize: '1.2rem',\n                  fontWeight: 'bold',\n                  mb: 0.5\n                }}>\n                  TON\n                </Typography>\n                <Typography sx={{ \n                  color: 'rgba(255,255,255,0.5)',\n                  fontSize: '0.8rem',\n                  textTransform: 'none'\n                }}>\n                  Balance: {formatBalance(userStats?.total, 'TON')}\n                </Typography>\n              </Box>\n            </Button>\n\n            <Button\n              onClick={() => setSelectedPayment('USDT')}\n              sx={{\n                flex: 1,\n                height: '64px',\n                background: selectedPayment === 'USDT' \n                  ? 'rgba(38, 161, 123, 0.15)'\n                  : 'rgba(110, 211, 255, 0.05)',\n                border: `1px solid ${selectedPayment === 'USDT' ? 'rgba(38, 161, 123, 0.3)' : 'rgba(110, 211, 255, 0.1)'}`,\n                borderRadius: '12px',\n                transition: 'all 0.3s ease',\n                transform: selectedPayment === 'USDT' ? 'scale(1.02)' : 'scale(1)',\n                boxShadow: selectedPayment === 'USDT' ? '0 8px 32px rgba(38, 161, 123, 0.15)' : 'none',\n                '&:hover': {\n                  background: selectedPayment === 'USDT'\n                    ? 'rgba(38, 161, 123, 0.2)'\n                    : 'rgba(110, 211, 255, 0.1)',\n                  transform: 'scale(1.02)',\n                  boxShadow: '0 8px 32px rgba(38, 161, 123, 0.2)'\n                }\n              }}\n            >\n              <Box sx={{ textAlign: 'center' }}>\n                <Typography sx={{ \n                  color: selectedPayment === 'USDT' ? '#26A17B' : 'rgba(255,255,255,0.6)',\n                  fontSize: '1.2rem',\n                  fontWeight: 'bold',\n                  mb: 0.5\n                }}>\n                  USDT\n                </Typography>\n                <Typography sx={{ \n                  color: selectedPayment === 'USDT' ? 'rgba(38, 161, 123, 0.7)' : 'rgba(255,255,255,0.5)',\n                  fontSize: '0.8rem',\n                  textTransform: 'none'\n                }}>\n                  Balance: {formatBalance(userStats?.usdt, 'USDT')}\n                </Typography>\n              </Box>\n            </Button>\n          </Box>\n\n          {/* Total Amount Display - New Simple Design */}\n          <Box sx={{ \n            display: 'flex', \n            justifyContent: 'space-between',\n            alignItems: 'center',\n            mb: 3,\n            px: 1\n          }}>\n            <Box sx={{ \n              display: 'flex', \n              alignItems: 'center', \n              gap: 1.5 \n            }}>\n              <Box component=\"img\"\n                src={selectedPayment === 'TON' ? tonLogo : usdtLogo}\n                alt={selectedPayment}\n                sx={{\n                  width: '24px',\n                  height: '24px',\n                  objectFit: 'contain'\n                }}\n              />\n              <Typography sx={{ \n                color: 'rgba(255,255,255,0.6)',\n                fontSize: '0.9rem',\n                fontWeight: '500'\n              }}>\n                Total Amount\n              </Typography>\n            </Box>\n\n            <Box sx={{ \n              display: 'flex', \n              alignItems: 'flex-end',\n              flexDirection: 'column',\n              gap: 0.5\n            }}>\n              <Typography sx={{ \n                color: selectedPayment === 'USDT' ? '#26A17B' : '#6ed3ff',\n                fontSize: { xs: '1.8rem', sm: '2rem' },\n                fontWeight: '700',\n                lineHeight: 1,\n                mt:2,\n                letterSpacing: '0.5px'\n              }}>\n                {calculateTotal()} {selectedPayment}\n              </Typography>\n              {selectedPayment === 'TON' ? (\n                tonPrice && (\n                  <Typography sx={{ \n                    color: 'rgba(255,255,255,0.5)',\n                    fontSize: '0.85rem'\n                  }}>\n                    ≈ ${(parseFloat(calculateTotal()) * tonPrice).toFixed(2)}\n                  </Typography>\n                )\n              ) : (\n                <Typography sx={{ \n                  color: 'rgba(255,255,255,0.5)',\n                  fontSize: '0.85rem'\n                }}>\n                  ≈ ${parseFloat(calculateTotal()).toFixed(2)}\n                </Typography>\n              )}\n            </Box>\n          </Box>\n\n          {/* Error Messages with improved design */}\n          {error && !error.includes('Successfully') && (\n            <Box sx={{ \n              width: '100%', \n              mb: 3,\n              background: 'linear-gradient(135deg, rgba(244, 67, 54, 0.05), rgba(244, 67, 54, 0.02))',\n              backdropFilter: 'blur(10px)',\n              border: '1px solid rgba(244, 67, 54, 0.2)',\n              borderRadius: '16px',\n              p: 3,\n              boxShadow: '0 8px 32px rgba(244, 67, 54, 0.1)',\n              animation: 'slideIn 0.3s ease',\n              display: 'flex',\n              flexDirection: 'column',\n              alignItems: 'center',\n              gap: 2\n            }}>\n              <Typography sx={{ \n                color: '#ff4444',\n                textAlign: 'center',\n                fontSize: '1rem',\n                fontWeight: '500',\n                display: 'flex',\n                alignItems: 'center',\n                gap: 1\n              }}>\n                <Box component=\"span\" sx={{\n                  width: '24px',\n                  height: '24px',\n                  borderRadius: '50%',\n                  background: 'rgba(244, 67, 54, 0.1)',\n                  display: 'flex',\n                  alignItems: 'center',\n                  justifyContent: 'center',\n                  fontSize: '16px'\n                }}>\n                  !\n                </Box>\n                {error}\n              </Typography>\n              \n              {neededAmount > 0 && (\n                <Box sx={{ \n                  display: 'flex',\n                  gap: 2,\n                  width: '100%',\n                  maxWidth: '400px'\n                }}>\n                  {selectedPayment === 'TON' ? (\n                    <Button\n                      fullWidth\n                      onClick={() => setShowDepositDrawer(true)}\n                      sx={{\n                        background: 'linear-gradient(135deg, #0088CC, #00A3FF)',\n                        color: 'white',\n                        py: 1.5,\n                        px: 4,\n                        borderRadius: '12px',\n                        fontSize: '1rem',\n                        fontWeight: 'bold',\n                        textTransform: 'none',\n                        transition: 'all 0.3s ease',\n                        boxShadow: '0 4px 15px rgba(0, 136, 204, 0.3)',\n                        '&:hover': {\n                          background: 'linear-gradient(135deg, #00A3FF, #0088CC)',\n                          transform: 'translateY(-2px)',\n                          boxShadow: '0 6px 20px rgba(0, 136, 204, 0.4)'\n                        },\n                        '&:active': {\n                          transform: 'translateY(0)'\n                        }\n                      }}\n                    >\n                      Deposit TON\n                    </Button>\n                  ) : (\n                    <Button\n                      fullWidth\n                      onClick={() => setShowSwapDrawer(true)}\n                      sx={{\n                        background: 'linear-gradient(135deg, #26A17B, #32D6A6)',\n                        color: 'white',\n                        py: 1.5,\n                        px: 4,\n                        borderRadius: '12px',\n                        fontSize: '1rem',\n                        fontWeight: 'bold',\n                        textTransform: 'none',\n                        transition: 'all 0.3s ease',\n                        boxShadow: '0 4px 15px rgba(38, 161, 123, 0.3)',\n                        '&:hover': {\n                          background: 'linear-gradient(135deg, #32D6A6, #26A17B)',\n                          transform: 'translateY(-2px)',\n                          boxShadow: '0 6px 20px rgba(38, 161, 123, 0.4)'\n                        },\n                        '&:active': {\n                          transform: 'translateY(0)'\n                        }\n                      }}\n                    >\n                      Get USDT\n                    </Button>\n                  )}\n                </Box>\n              )}\n            </Box>\n          )}\n\n          <style>\n            {`\n              @keyframes slideIn {\n                from {\n                  opacity: 0;\n                  transform: translateY(-20px);\n                }\n                to {\n                  opacity: 1;\n                  transform: translateY(0);\n                }\n              }\n              @keyframes pulse {\n                0% {\n                  opacity: 0.5;\n                }\n                50% {\n                  opacity: 0.2;\n                }\n                100% {\n                  opacity: 0.5;\n                }\n              }\n            `}\n          </style>\n\n          {/* Confirm Purchase Button */}\n          <Button\n            variant=\"contained\"\n            fullWidth\n            onClick={handleConfirmPurchase}\n            disabled={!canPurchase()}\n            sx={{\n              position: 'relative',\n              overflow: 'hidden',\n              background: !canPurchase()\n                ? 'rgba(110, 211, 255, 0.05)'\n                : selectedPayment === 'USDT'\n                  ? 'linear-gradient(135deg, #26A17B 0%, #32D6A6 100%)'\n                  : 'linear-gradient(135deg, #6ed3ff 0%, #6ed3ff80 100%)',\n              color: !canPurchase()\n                ? 'rgba(255,255,255,0.3)'\n                : 'white',\n              fontSize: { xs: '1.2rem', sm: '1.4rem' },\n              fontWeight: 'bold',\n              py: { xs: 2, sm: 2.5 },\n              borderRadius: '16px',\n              textTransform: 'none',\n              boxShadow: !canPurchase() \n                ? 'none' \n                : selectedPayment === 'USDT'\n                  ? '0 8px 32px rgba(38, 161, 123, 0.2)'\n                  : '0 8px 32px rgba(110, 211, 255, 0.2)',\n              border: !canPurchase()\n                ? '1px solid rgba(110, 211, 255, 0.1)'\n                : 'none',\n              transition: 'all 0.3s cubic-bezier(0.4, 0, 0.2, 1)',\n              mb: !canPurchase() ? 2 : 0,\n              '&::before': {\n                content: '\"\"',\n                position: 'absolute',\n                top: 0,\n                left: '-100%',\n                width: '200%',\n                height: '100%',\n                background: 'linear-gradient(90deg, transparent, rgba(255,255,255,0.2), transparent)',\n                transition: 'all 0.5s ease',\n              },\n              '&:hover': {\n                background: !canPurchase()\n                  ? 'rgba(110, 211, 255, 0.05)'\n                  : selectedPayment === 'USDT'\n                    ? 'linear-gradient(135deg, #32D6A6 0%, #26A17B 100%)'\n                    : 'linear-gradient(135deg, #6ed3ff80 0%, #6ed3ff 100%)',\n                boxShadow: !canPurchase() \n                  ? 'none' \n                  : selectedPayment === 'USDT'\n                    ? '0 12px 40px rgba(38, 161, 123, 0.3)'\n                    : '0 12px 40px rgba(110, 211, 255, 0.3)',\n                transform: !canPurchase() ? 'none' : 'translateY(-2px)',\n                '&::before': {\n                  left: '100%'\n                }\n              }\n            }}\n          >\n            {!canPurchase() ? (\n              <Box sx={{ \n                display: 'flex', \n                alignItems: 'center', \n                gap: 1,\n                position: 'relative',\n                '&::before': {\n                  content: '\"\"',\n                  position: 'absolute',\n                  top: '-2px',\n                  left: '-10px',\n                  right: '-10px',\n                  bottom: '-2px',\n                  background: 'linear-gradient(90deg, transparent, rgba(110, 211, 255, 0.1), transparent)',\n                  animation: 'pulse 2s infinite'\n                }\n              }}>\n                <Box component=\"span\" sx={{\n                  width: '24px',\n                  height: '24px',\n                  borderRadius: '50%',\n                  background: 'rgba(110, 211, 255, 0.1)',\n                  border: '1px solid rgba(110, 211, 255, 0.2)',\n                  display: 'flex',\n                  alignItems: 'center',\n                  justifyContent: 'center',\n                  fontSize: '14px',\n                  color: '#6ed3ff',\n                  fontWeight: 'bold'\n                }}>\n                  !\n                </Box>\n                <Box component=\"span\" sx={{\n                  display: 'flex',\n                  flexDirection: 'column',\n                  alignItems: 'flex-start',\n                  gap: 0.2\n                }}>\n                  <Typography sx={{ \n                    fontSize: { xs: '1rem', sm: '1.1rem' },\n                    color: 'rgba(255,255,255,0.5)',\n                    fontWeight: 'normal'\n                  }}>\n                    Insufficient Balance\n                  </Typography>\n                 \n                </Box>\n              </Box>\n            ) : (\n              'Confirm Purchase'\n            )}\n          </Button>\n\n          {/* Quick Action Button - Only show if balance is insufficient */}\n          {!canPurchase() && (\n            <Button\n              fullWidth\n              onClick={() => selectedPayment === 'TON' ? setShowDepositDrawer(true) : setShowSwapDrawer(true)}\n              sx={{\n                background: selectedPayment === 'TON' \n                  ? 'rgba(0, 136, 204, 0.1)'\n                  : 'rgba(38, 161, 123, 0.1)',\n                color: selectedPayment === 'TON' ? '#00A3FF' : '#32D6A6',\n                py: 1.5,\n                borderRadius: '12px',\n                fontSize: '1rem',\n                fontWeight: 'bold',\n                textTransform: 'none',\n                border: `1px solid ${selectedPayment === 'TON' \n                  ? 'rgba(0, 136, 204, 0.2)' \n                  : 'rgba(38, 161, 123, 0.2)'}`,\n                transition: 'all 0.3s ease',\n                '&:hover': {\n                  background: selectedPayment === 'TON'\n                    ? 'rgba(0, 136, 204, 0.15)'\n                    : 'rgba(38, 161, 123, 0.15)',\n                  transform: 'translateY(-2px)',\n                  boxShadow: selectedPayment === 'TON'\n                    ? '0 8px 32px rgba(0, 136, 204, 0.2)'\n                    : '0 8px 32px rgba(38, 161, 123, 0.2)'\n                }\n              }}\n            >\n              {selectedPayment === 'TON' ? 'Deposit TON' : 'Get USDT'}\n            </Button>\n          )}\n        </Box>\n      </Drawer>\n\n      {/* Deposit Drawer */}\n      <DepositDrawer\n        open={showDepositDrawer}\n        onClose={() => setShowDepositDrawer(false)}\n      />\n\n      {/* Swap Drawer */}\n      <SwapDrawer\n        open={showSwapDrawer}\n        onClose={() => setShowSwapDrawer(false)}\n        defaultAmount={neededAmount}\n        onSwapComplete={() => {\n          setShowSwapDrawer(false);\n          setError(null);\n        }}\n      />\n\n      {/* Add Snackbar at the end of the component */}\n      <Snackbar\n        open={showSuccessSnackbar}\n        autoHideDuration={3000}\n        onClose={() => setShowSuccessSnackbar(false)}\n        anchorOrigin={{ vertical: 'bottom', horizontal: 'right' }}\n      >\n        <Alert \n          onClose={() => setShowSuccessSnackbar(false)}\n          severity=\"success\"\n          sx={{ \n            background: 'linear-gradient(135deg, #4CAF50, #45a049)',\n            color: 'white',\n            '& .MuiAlert-icon': {\n              color: 'white'\n            }\n          }}\n        >\n          {successMessage}\n        </Alert>\n      </Snackbar>\n    </Container>\n  );\n};\n\nexport default BoxDetail; "],"names":["generateReward","boxId","box","boxesData","allowedDrops","drop","totalProbability","sum","random","validDrops","firstValidDrop","usdtLogo","commonStyles","BoxDetail","navigate","useNavigate","useParams","boxData","userStats","setUserStats","useState","isOpening","setIsOpening","currentReward","setCurrentReward","showReward","setShowReward","error","setError","loading","setLoading","showPurchaseModal","setShowPurchaseModal","quantity","setQuantity","tonPrice","setTonPrice","selectedPayment","setSelectedPayment","showDepositDrawer","setShowDepositDrawer","showSwapDrawer","setShowSwapDrawer","neededAmount","setNeededAmount","showSuccessSnackbar","setShowSuccessSnackbar","successMessage","setSuccessMessage","useEffect","telegramUserId","unsubscribe","onSnapshot","doc","db","data","fetchTonPrice","response","axios","newTonPrice","interval","canPurchase","updateUserStats","userId","reward","userRef","updates","increment","userDrops","getDoc","existingDropIndex","updateDoc","getBoxOpeningStatus","stats","hasGiftBox","hasKeys","boxCount","_a","handleOpenBox","status","d","handleBuyBox","handleQuantityChange","change","newQuantity","handleConfirmPurchase","totalPrice","calculateTotal","userBalance","needed","usdPrice","formatBalance","value","paymentType","getUserBalance","jsx","Container","jsxs","Box","Typography","Button","CircularProgress","title","image","description","normalPrice","salePrice","drops","IconButton","ArrowBackIcon","Grid","motion","Fragment","PackageOpenIcon","_b","KeyIcon","BoxOpenAnimation","RewardDisplay","a","b","item","index","rarity","Drawer","CloseIcon","RemoveIcon","AddIcon","tonLogo","DepositDrawer","SwapDrawer","Snackbar","Alert"],"mappings":"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"}